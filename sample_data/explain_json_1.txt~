EXPLAIN
{\n  "query_block": {\n    "union_result": {\n      "using_temporary_table": true,\n      "table_name": "<union1,4>",\n      "access_type": "ALL",\n      "query_specifications": [\n        {\n          "dependent": false,\n          "cacheable": true,\n          "query_block": {\n            "select_id": 1,\n            "table": {\n              "table_name": "der_1",\n              "access_type": "ALL",\n              "rows": 4,\n              "filtered": 100,\n              "materialized_from_subquery": {\n                "using_temporary_table": true,\n                "dependent": false,\n                "cacheable": true,\n                "query_block": {\n                  "union_result": {\n                    "using_temporary_table": true,\n                    "table_name": "<union2,3>",\n                    "access_type": "ALL",\n                    "query_specifications": [\n                      {\n                        "dependent": false,\n                        "cacheable": true,\n                        "query_block": {\n                          "select_id": 2,\n                          "table": {\n                            "table_name": "actor_1",\n                            "access_type": "index",\n                            "key": "PRIMARY",\n                            "used_key_parts": [\n                              "id_1"\n                            ],\n                            "key_length": "4",\n                            "rows": 2,\n                            "filtered": 100,\n                            "using_index": true\n                          }\n                        }\n                      },\n                      {\n                        "dependent": false,\n                        "cacheable": true,\n                        "query_block": {\n                          "select_id": 3,\n                          "table": {\n                            "table_name": "actor_2",\n                            "access_type": "index",\n                            "key": "PRIMARY",\n                            "used_key_parts": [\n                              "id_1"\n                            ],\n                            "key_length": "4",\n                            "rows": 2,\n                            "filtered": 100,\n                            "using_index": true\n                          }\n                        }\n                      }\n                    ]\n                  }\n                }\n              }\n            }\n          }\n        },\n        {\n          "dependent": false,\n          "cacheable": true,\n          "query_block": {\n            "select_id": 4,\n            "table": {\n              "table_name": "der_2",\n              "access_type": "ALL",\n              "rows": 8,\n              "filtered": 100,\n              "materialized_from_subquery": {\n                "using_temporary_table": true,\n                "dependent": false,\n                "cacheable": true,\n                "query_block": {\n                  "select_id": 5,\n                  "nested_loop": [\n                    {\n                      "table": {\n                        "table_name": "booking_count",\n                        "access_type": "ALL",\n                        "rows": 4,\n                        "filtered": 100,\n                        "materialized_from_subquery": {\n                          "using_temporary_table": true,\n                          "dependent": false,\n                          "cacheable": true,\n                          "query_block": {\n                            "select_id": 6,\n                            "nested_loop": [\n                              {\n                                "table": {\n                                  "table_name": "current_table",\n                                  "access_type": "ALL",\n                                  "rows": 2,\n                                  "filtered": 100,\n                                  "materialized_from_subquery": {\n                                    "using_temporary_table": true,\n                                    "dependent": false,\n                                    "cacheable": true,\n                                    "query_block": {\n                                      "select_id": 7,\n                                      "grouping_operation": {\n                                        "using_filesort": true,\n                                        "nested_loop": [\n                                          {\n                                            "table": {\n                                              "table_name": "ur",\n                                              "access_type": "system",\n                                              "rows": 1,\n                                              "filtered": 100\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "b",\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "b_i1",\n                                                "b_i2",\n                                                "b_i3"\n                                              ],\n                                              "key": "b_i3",\n                                              "used_key_parts": [\n                                                "id_1"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "const"\n                                              ],\n                                              "rows": 1,\n                                              "filtered": 100,\n                                              "attached_condition": "((`test2`.`b`.`id_1` = '1') and (((`test2`.`b`.`property_id` in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888)) and (`test2`.`b`.`arrival` between '2012-07-01' and '2012-07-31') and (`test2`.`b`.`arrival` < <cache>(curdate()))) and (`test2`.`b`.`property_id` is not null)))"\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "p",\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "i2"\n                                              ],\n                                              "key": "i2",\n                                              "used_key_parts": [\n                                                "id_1"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "test2.b.property_id"\n                                              ],\n                                              "rows": 2,\n                                              "filtered": 100\n                                            }\n                                          }\n                                        ]\n                                      }\n                                    }\n                                  }\n                                }\n                              },\n                              {\n                                "table": {\n                                  "table_name": "historic_table",\n                                  "access_type": "ref",\n                                  "possible_keys": [\n                                    "<auto_key0>"\n                                  ],\n                                  "key": "<auto_key0>",\n                                  "used_key_parts": [\n                                    "id_1"\n                                  ],\n                                  "key_length": "4",\n                                  "ref": [\n                                    "current_table.id_1"\n                                  ],\n                                  "rows": 2,\n                                  "filtered": 100,\n                                  "materialized_from_subquery": {\n                                    "using_temporary_table": true,\n                                    "dependent": false,\n                                    "cacheable": true,\n                                    "query_block": {\n                                      "select_id": 8,\n                                      "grouping_operation": {\n                                        "using_filesort": true,\n                                        "nested_loop": [\n                                          {\n                                            "table": {\n                                              "table_name": "ur",\n                                              "access_type": "system",\n                                              "rows": 1,\n                                              "filtered": 100\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "b",\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "b_i1",\n                                                "b_i2",\n                                                "b_i3"\n                                              ],\n                                              "key": "b_i3",\n                                              "used_key_parts": [\n                                                "id_1"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "const"\n                                              ],\n                                              "rows": 1,\n                                              "filtered": 100,\n                                              "attached_condition": "((`test2`.`b`.`id_1` = '1') and (((`test2`.`b`.`property_id` in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888)) and (`test2`.`b`.`arrival` between '2012-06-01' and '2012-06-30') and (`test2`.`b`.`arrival` < <cache>(curdate()))) and (`test2`.`b`.`property_id` is not null)))"\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "p",\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "i2"\n                                              ],\n                                              "key": "i2",\n                                              "used_key_parts": [\n                                                "id_1"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "test2.b.property_id"\n                                              ],\n                                              "rows": 2,\n                                              "filtered": 100\n                                            }\n                                          }\n                                        ]\n                                      }\n                                    }\n                                  }\n                                }\n                              }\n                            ]\n                          }\n                        }\n                      }\n                    },\n                    {\n                      "table": {\n                        "table_name": "guests_exposed",\n                        "access_type": "ref",\n                        "possible_keys": [\n                          "<auto_key0>"\n                        ],\n                        "key": "<auto_key0>",\n                        "used_key_parts": [\n                          "id_1"\n                        ],\n                        "key_length": "4",\n                        "ref": [\n                          "booking_count.id_1"\n                        ],\n                        "rows": 2,\n                        "filtered": 100,\n                        "materialized_from_subquery": {\n                          "using_temporary_table": true,\n                          "dependent": false,\n                          "cacheable": true,\n                          "query_block": {\n                            "select_id": 9,\n                            "nested_loop": [\n                              {\n                                "table": {\n                                  "table_name": "current_table",\n                                  "access_type": "ALL",\n                                  "rows": 3,\n                                  "filtered": 100,\n                                  "materialized_from_subquery": {\n                                    "using_temporary_table": true,\n                                    "dependent": false,\n                                    "cacheable": true,\n                                    "query_block": {\n                                      "select_id": 10,\n                                      "grouping_operation": {\n                                        "using_temporary_table": true,\n                                        "using_filesort": true,\n                                        "nested_loop": [\n                                          {\n                                            "table": {\n                                              "table_name": "p",\n                                              "access_type": "ALL",\n                                              "possible_keys": [\n                                                "i2"\n                                              ],\n                                              "rows": 3,\n                                              "filtered": 100,\n                                              "attached_condition": "(`test2`.`p`.`id_1` in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888))"\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "e",\n                                              "partitions": [\n                                                "p1",\n                                                "p9",\n                                                "p13",\n                                                "p15",\n                                                "p21",\n                                                "p41",\n                                                "p63",\n                                                "p67",\n                                                "p71",\n                                                "p77",\n                                                "p83",\n                                                "p86"\n                                              ],\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "property_ts",\n                                                "arrival_ts"\n                                              ],\n                                              "key": "property_ts",\n                                              "used_key_parts": [\n                                                "property_id"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "test2.p.id_1"\n                                              ],\n                                              "rows": 1,\n                                              "filtered": 100,\n                                              "using_index": true,\n                                              "attached_condition": "((`test2`.`e`.`gad` between '2012-07-01' and '2012-07-31') and (`test2`.`e`.`gad` < <cache>(curdate())))"\n                                            }\n                                          }\n                                        ]\n                                      }\n                                    }\n                                  }\n                                }\n                              },\n                              {\n                                "table": {\n                                  "table_name": "historic_table",\n                                  "access_type": "ref",\n                                  "possible_keys": [\n                                    "<auto_key0>"\n                                  ],\n                                  "key": "<auto_key0>",\n                                  "used_key_parts": [\n                                    "id_1"\n                                  ],\n                                  "key_length": "4",\n                                  "ref": [\n                                    "current_table.id_1"\n                                  ],\n                                  "rows": 2,\n                                  "filtered": 100,\n                                  "materialized_from_subquery": {\n                                    "using_temporary_table": true,\n                                    "dependent": false,\n                                    "cacheable": true,\n                                    "query_block": {\n                                      "select_id": 11,\n                                      "grouping_operation": {\n                                        "using_temporary_table": true,\n                                        "using_filesort": true,\n                                        "nested_loop": [\n                                          {\n                                            "table": {\n                                              "table_name": "p",\n                                              "access_type": "ALL",\n                                              "possible_keys": [\n                                                "i2"\n                                              ],\n                                              "rows": 3,\n                                              "filtered": 100,\n                                              "attached_condition": "(`test2`.`p`.`id_1` in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888))"\n                                            }\n                                          },\n                                          {\n                                            "table": {\n                                              "table_name": "e",\n                                              "partitions": [\n                                                "p1",\n                                                "p9",\n                                                "p13",\n                                                "p15",\n                                                "p21",\n                                                "p41",\n                                                "p63",\n                                                "p67",\n                                                "p71",\n                                                "p77",\n                                                "p83",\n                                                "p86"\n                                              ],\n                                              "access_type": "ref",\n                                              "possible_keys": [\n                                                "property_ts",\n                                                "arrival_ts"\n                                              ],\n                                              "key": "property_ts",\n                                              "used_key_parts": [\n                                                "property_id"\n                                              ],\n                                              "key_length": "4",\n                                              "ref": [\n                                                "test2.p.id_1"\n                                              ],\n                                              "rows": 1,\n                                              "filtered": 100,\n                                              "using_index": true,\n                                              "attached_condition": "((`test2`.`e`.`gad` between '2012-06-01' and '2012-06-30') and (`test2`.`e`.`gad` < <cache>(curdate())))"\n                                            }\n                                          }\n                                        ]\n                                      }\n                                    }\n                                  }\n                                }\n                              }\n                            ]\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          }\n        }\n      ]\n    }\n  }\n}
