explain select der_1.id_1 from ( select actor_1.id_1 from actor as actor_1  union  select actor_2.id_1 from actor as actor_2 ) as der_1  union  select der_2.id_1 from ( select actor_3.id_1 from actor as actor_3  union all select actor_4.id_1 from actor as actor_4 ) as der_2;

explain select booking_count.id, booking_count.property_name, (booking_count.current / guests_exposed.current) as current, (booking_count.historic / guests_exposed.historic) as historic  from (select current_table.id, current_table.name as property_name, current_table.value as current, historic_table.value as historic  from (select count(distinct b.id) as value, p.name, p.id  from x_booking b, x_property p, x_upgrade_request ur where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate()  group by b.property_id) current_table, (select count(distinct b.id) as value, p.name, p.id  from x_booking b, x_property p, x_upgrade_request ur where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate()  group by b.property_id) historic_table where current_table.id = historic_table.id) booking_count, (select current_table.id, current_table.name as property_name, current_table.guests_exposed as current, historic_table.guests_exposed as historic  from (select count(e.gad) as guests_exposed, p.id, p.name  from x_property p, exposure e where p.id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and e.gad between '2012-07-01' and '2012-07-31' and e.gad < curdate() and e.property_id = p.id  group by e.property_id) current_table, (select count(e.gad) as guests_exposed, p.id, p.name  from x_property p,exposure e where p.id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and e.property_id = p.id  and e.gad between '2012-06-01' and '2012-06-30' and e.gad < curdate()  group by e.property_id) historic_table where current_table.id = historic_table.id  order by current_table.id) guests_exposed where booking_count.id = guests_exposed.id  order by booking_count.id;


explain select booking_awarded_count.id, booking_awarded_count.property_name as property_name, (booking_awarded_count.current / booking_count.current) as current, (booking_awarded_count.historic / booking_count.historic) as historic  from (select current_table.id, current_table.name as property_name, current_table.value as current, historic_table.value as historic  from (select count(distinct b.id) as value, p.name, p.id  from x_property p, x_booking b, x_upgrade_request ur where b.property_id in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and ur.awarded = 'yes' and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate()  group by b.property_id) current_table, (select count(distinct b.id) as value, p.name, p.id  from x_property p, x_booking b, x_upgrade_request ur where b.property_id in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id  and b.id = ur.booking_id and ur.awarded = 'yes' and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate()  group by b.property_id) historic_table where current_table.id = historic_table.id) booking_awarded_count, (select current_table.id, current_table.name as property_name, current_table.value as current, historic_table.value as historic  from (select count(distinct b.id) as value, p.name, p.id  from x_booking b, x_property p, x_upgrade_request ur where b.property_id in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate()  group by b.property_id) current_table, (select count(distinct b.id) as value, p.name, p.id  from x_booking b, x_property p, x_upgrade_request ur where b.property_id in (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate() group by b.property_id) historic_table where current_table.id = historic_table.id) booking_count where booking_awarded_count.id = booking_count.id;



explain select total_awarded.id, total_awarded.property_name, (total_awarded.current / total_nights.current_total_nights) as current, (total_awarded.historic / total_nights.historic_total_nights) as historic  from (select current_table.id, current_table.name as property_name, current_table.value as current, historic_table.value as historic  from (select sum(ur.total) as value, p.name, p.id  from x_booking b, x_upgrade_request ur, x_property p where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.id = ur.`booking_id` and b.property_id = p.id and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate() and ur.awarded = 'yes'  group by ur.property_id) current_table, (select sum(ur.total) as value, p.name, p.id  from x_booking b, x_upgrade_request ur, x_property p where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.id = ur.`booking_id` and b.property_id = p.id and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate() and ur.awarded = 'yes'  group by ur.property_id) historic_table where current_table.id = historic_table.id  order by id) total_awarded, (select current_table.id, current_table.name as property_name, current_table.value as current_total_nights, historic_table.value as historic_total_nights  from (select sum(awarded_nights.nights) as value, awarded_nights.id, awarded_nights.name  from (select distinct b.id as distinct_b_id,  b.nights,  p.name,  p.id  from x_property p, x_booking b, x_upgrade_request ur where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate() and ur.awarded = 'yes') awarded_nights  group by awarded_nights.ID) current_table, (select sum(awarded_nights.nights) as value, awarded_nights.id, awarded_nights.name  from (select distinct b.id as distinct_b_id,  b.nights,  p.name,  p.id  from x_property p, x_booking b, x_upgrade_request ur where b.property_id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate() and ur.awarded = 'yes') awarded_nights  group by awarded_nights.ID) historic_table where current_table.id = historic_table.id) total_nights where total_awarded.id = total_nights.id;




explain select current_table.id, current_table.name as property_name, current_table.value as current, historic_table.value as historic  from (select avg_awarded_nights.id, avg_awarded_nights.name, avg (avg_awarded_nights.value) as value  from (select distinct b.id as distinct_booking_id,  b.nights as value,  p.name,  p.id  from x_property p, x_booking b, x_upgrade_request ur where p.id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and ur.awarded = 'yes' and b.arrival between '2012-07-01' and '2012-07-31' and b.arrival < curdate()) avg_awarded_nights  group by avg_awarded_nights.id) current_table, (select avg_awarded_nights.id, avg_awarded_nights.name, avg(avg_awarded_nights.value) as value  from (select distinct b.id as distinct_booking_id,  b.nights as value,  p.name,  p.id  from x_property p, x_booking b, x_upgrade_request ur where p.id in  (87,856,694,1056,474,1301,455,1943,20,808,190,426,1888) and b.property_id = p.id and b.id = ur.booking_id and ur.awarded = 'yes' and b.arrival between '2012-06-01' and '2012-06-30' and b.arrival < curdate()) avg_awarded_nights  group by avg_awarded_nights.id) historic_table where current_table.id = historic_table.id;




        
